#include <stdio.h>
#include <stdlib.h>

#include "rTDoA_est_opt.h"

int main(){
    double x_t[3];

#ifndef TEST
    uint64_t ts_uint64[NUM_ANCH][4] = { {378149757023,     378220060738,                0,         70303564},
                                        {378341467868,     378411771677,        191710207,        262013859},
                                        {378533160870,     378603464605,        383403376,        453706968},
                                        {378724852441,     378795156115,        575094736,        645398253},
                                        {378916545942,     378986849708,        766787925,        837091558},
                                        {379108240634,     379178544608,        958483528,       1028787438}};
                                        
    for(int i=0;i<100;i++) rTDoA(ts_uint64, x_t);
#else
    double ts_mat[NUM_ANCH][4] = {  {5.918058847642850,   5.919159103599600,                   0,   0.001100253593600},
                                    {5.921059130051249,   5.922159387479099,   0.003000272423700,   0.004100527394500},
                                    {5.924059133201050,   5.925159389470799,   0.006000278202700,   0.007100532218850},
                                    {5.927059113971350,   5.928159369286449,   0.009000255655200,   0.010100508513250},
                                    {5.930059124946149,   5.931159381701050,   0.012000261747200,   0.013100516420650},
                                    {5.933059154560100,   5.934159414570200,   0.015000305618300,   0.016100564626800}};
    rTDoA(ts_mat, x_t);
#endif

    printf("\nRESULT xt: ");
    for(int i=0; i<3; i++) printf("%f ",x_t[i]);
    printf("\n\n");

    // for(int i=0; i<NUM_ANCH;i++){
    //     for(int j=0; j<4; j++){
    //         printf("%d ", ts_uint64[i][j]);
    //     }
    //     printf("\n");
    // }

    return 0;
}